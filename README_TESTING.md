# Руководство по тестированию

Этот проект включает автоматические тесты для ключевых функций приложения.

## Установка зависимостей

### Backend
```bash
cd backend
npm install
```

### Frontend
```bash
cd frontend
npm install
```

## Запуск тестов

### Backend тесты (Jest)

Запустить все тесты:
```bash
cd backend
npm test
```

Запустить тесты в режиме наблюдения:
```bash
npm run test:watch
```

Запустить тесты с покрытием кода:
```bash
npm run test:coverage
```

### Frontend тесты (Vitest)

Запустить все тесты:
```bash
cd frontend
npm test
```

Запустить тесты с UI:
```bash
npm run test:ui
```

Запустить тесты с покрытием кода:
```bash
npm run test:coverage
```

## Описание тестов

### 1. Тесты авторизации (`backend/__tests__/auth.test.js`)

Покрывают следующие сценарии:
- ✅ Валидация обязательных полей (email, password)
- ✅ Обработка несуществующего пользователя
- ✅ Обработка неверного пароля
- ✅ Успешная авторизация с валидными данными
- ✅ Обработка требования смены пароля

### 2. Тесты добавления подкатегории услуг (`backend/__tests__/servicesCategory.test.js`)

Покрывают следующие сценарии:
- ✅ Успешное создание новой подкатегории
- ✅ Обработка дублирующегося pageType
- ✅ Использование значений по умолчанию
- ✅ Обработка ошибок при создании страницы контента
- ✅ Обработка внутренних ошибок сервера

### 3. Тесты капчи

#### Backend (`backend/__tests__/captcha.test.js`)
- ✅ Генерация строки правильной длины (7 символов)
- ✅ Генерация уникальных значений
- ✅ Валидация допустимых символов
- ✅ Проверка формата (только буквы и цифры)

#### Frontend (`frontend/src/__tests__/captcha.test.ts`)
- ✅ Генерация строки правильной длины
- ✅ Генерация уникальных значений
- ✅ Валидация допустимых символов
- ✅ Проверка формата
- ✅ Множественные последовательные вызовы

## Структура тестов

```
backend/
  __tests__/
    auth.test.js              # Тесты авторизации
    servicesCategory.test.js  # Тесты подкатегорий услуг
    captcha.test.js           # Тесты капчи (backend)

frontend/
  src/
    __tests__/
      setup.ts                # Настройка тестовой среды
      captcha.test.ts         # Тесты капчи (frontend)
  vitest.config.ts            # Конфигурация Vitest
```

## Примечания

- Backend тесты используют Jest с моками Prisma Client
- Frontend тесты используют Vitest с jsdom окружением
- Все тесты изолированы и не требуют реальной базы данных
- Моки используются для имитации внешних зависимостей



